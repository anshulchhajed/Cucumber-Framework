pipeline {
    agent any

    tools {
        // Install the Maven version configured as "M3" and add it to the path.
        maven 'MAVEN_HOME'
        jdk 'JAVA_HOME'
    }

    stages {
        stage('Clean') {
                steps {
              
                bat "mvn clean"
                     }
                 }
    
        stage('Test'){
                steps{
            bat "mvn install"
             emailext (
             attachmentsPattern: '**/targetcucumer-reports/report.html',
            subject: "STARTED: Job '${env.JOB_NAME} [${env.BUILD_NUMBER}]'",
            body: "STARTED: Job '${env.JOB_NAME} [${env.BUILD_NUMBER}]'",
            mimeType: 'text/html',
            to: "ianshul19@gmail.com"
          )
     
          }
        }
      }
      post {
    success {
      emailext (
          attachmentsPattern: '**/targetcucumer-reports/report.html',
          subject: "SUCCESSFUL: Job '${env.JOB_NAME} [${env.BUILD_NUMBER}]'",
           body: "STARTED: Job '${env.JOB_NAME} [${env.BUILD_NUMBER}]'",
          mimeType: 'text/html',
          to: "ianshul19@gmail.com"
          )
          publishHTML([allowMissing: false, alwaysLinkToLastBuild: false, keepAll: false, reportDir: 'target/cucumber-reports', reportFiles: 'index.html', reportName: 'HTML Report', reportTitles: 'Report'])
    }

    failure {
      emailext (
         attachmentsPattern: '**/targetcucumer-reports/report.html',
          subject: "FAILED: Job '${env.JOB_NAME} [${env.BUILD_NUMBER}]'",
          body: "STARTED: Job '${env.JOB_NAME} [${env.BUILD_NUMBER}]'",
          mimeType: 'text/html',
         to: "ianshul19@gmail.com"
        )
    }
 
    }
    }
